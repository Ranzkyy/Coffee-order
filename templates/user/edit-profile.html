{% extends 'layout.html' %}
{% block title %}Edit Profile{% endblock %}
{% block content %}
<div class="container mt-5">
    <h1>Edit Profile</h1>
    <form method="POST" action="{{ url_for('edit_profile') }}" enctype="multipart/form-data">
        <div class="mb-3">
            <label for="username" class="form-label">Username</label>
            <input type="text" id="username" name="username" value="{{ user.username }}" class="form-control" required>
        </div>
        <div class="mb-3">
            <label class="form-label">Profile Picture</label>
            <div class="d-flex align-items-center">
                <!-- Gambar Lama -->
                <div class="me-3 text-center">
                    <h6>Current Image</h6>
                    <img src="{{ url_for('static', filename='img/upload/' + user.image) }}" alt="Current Profile Image" id="oldImage" class="img-thumbnail" style="max-width: 150px;">
                </div>
                <!-- Gambar Baru -->
                <div class="text-center">
                    <h6>New Image</h6>
                    <img id="newImagePreview" class="img-thumbnail" style="max-width: 150px;" alt="New Profile Image Preview">
                </div>
            </div>
        </div>
        <div class="mb-3">
            <label for="user_image" class="form-label">Upload New Image</label>
            <input type="file" id="user_image" name="user_image" class="form-control" accept="image/*" onchange="previewNewImage(event)">
        </div>
        <button type="submit" class="btn btn-success">Save Changes</button>
        <a href="{{ url_for('profile') }}" class="btn btn-secondary">Cancel</a>
    </form>
</div>

<script>
    // Preview gambar baru sebelum upload
    function previewNewImage(event) {
        const file = event.target.files[0];
        const preview = document.getElementById('newImagePreview');
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                preview.src = e.target.result;
            };
            reader.readAsDataURL(file);
        } else {
            preview.src = ''; // Kosongkan preview jika tidak ada file
        }
    }
</script>
{% endblock %}
